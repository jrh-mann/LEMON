{
  "inputs": [],
  "outputs": [
    {
      "name": "Mark as Normal / Satisfactory",
      "description": "Tests have normalised or notably improved; mark as normal/satisfactory"
    },
    {
      "name": "Code as normal USS and file",
      "description": "Findings present for <3 months and FIB4/NAFLD normal; code as normal USS and file"
    },
    {
      "name": "No Concern, or escalation required",
      "description": "No concern or escalation required after telephone consultation"
    },
    {
      "name": "Refer to Secondary Care once bloods are back, irrespective of diagnosis or if all tests normal",
      "description": "Refer to secondary care after Phase 4 bloods"
    },
    {
      "name": "Requires MRCP via Gastroenterology",
      "description": "Patient requires MRCP referral via Gastroenterology"
    },
    {
      "name": "manage risk factors and co-morbidities - Annual Screening",
      "description": "Manage risk factors and co-morbidities with annual screening (NAFLD F0-F2, low/indeterminate FIB-4)"
    }
  ],
  "tree": {
    "start": {
      "id": "start",
      "type": "start",
      "label": "Liver Pathology Suspected & Work up Initiated",
      "children": [
        {
          "id": "n_phase1",
          "type": "action",
          "label": "Phase 1: Send Acuflix Template & request alcohol info",
          "input_ids": [],
          "edge_label": "",
          "children": [
            {
              "id": "n_phase2",
              "type": "action",
              "label": "Phase 2: Baseline & Phase 2 Bloods: LFT, FBC, AST, GGT (To allow FIB4 Calculation)",
              "input_ids": [],
              "edge_label": "",
              "children": [
                {
                  "id": "d_tests_normalise",
                  "type": "decision",
                  "label": "Tests normalise or notably improve?",
                  "input_ids": [],
                  "condition": {
                    "input_id": "input_tests_normalise_bool",
                    "comparator": "is_true"
                  },
                  "children": [
                    {
                      "id": "out_normal_satisfactory",
                      "type": "output",
                      "label": "Mark as Normal / Satisfactory",
                      "edge_label": "true",
                      "children": []
                    },
                    {
                      "id": "d_alt_abnormal",
                      "type": "decision",
                      "label": "ALT remains abnormal, worsens and/or additional tests are abnormal too?",
                      "input_ids": [],
                      "condition": {
                        "input_id": "input_alt_status_enum",
                        "comparator": "enum_eq",
                        "value": "abnormal_or_worsening"
                      },
                      "edge_label": "false",
                      "children": [
                        {
                          "id": "n_recheck",
                          "type": "action",
                          "label": "Recheck Baseline Liver Profile in appropriate timeframe",
                          "input_ids": [],
                          "edge_label": "true",
                          "children": [
                            {
                              "id": "d_findings_duration",
                              "type": "decision",
                              "label": "Findings present for >=3 months?",
                              "input_ids": [],
                              "condition": {
                                "input_id": "input_findings_duration_enum",
                                "comparator": "enum_eq",
                                "value": ">=3 months"
                              },
                              "children": [
                                {
                                  "id": "n_fib4_nafld",
                                  "type": "action",
                                  "label": "FIB 4 Score & NAFLD Fibrosis Score",
                                  "input_ids": [],
                                  "edge_label": "true",
                                  "children": [
                                    {
                                      "id": "d_sustained_worsening",
                                      "type": "decision",
                                      "label": "Sustained or worsening abnormalities?",
                                      "input_ids": [],
                                      "condition": {
                                        "input_id": "input_sustained_worsening_bool",
                                        "comparator": "is_true"
                                      },
                                      "children": [
                                        {
                                          "id": "n_consultation",
                                          "type": "action",
                                          "label": "Patient needs consultation for liver pathology and consent for further testing",
                                          "input_ids": [],
                                          "edge_label": "true",
                                          "children": [
                                            {
                                              "id": "n_phase3",
                                              "type": "action",
                                              "label": "Phase 3",
                                              "input_ids": [],
                                              "edge_label": "",
                                              "children": [
                                                {
                                                  "id": "n_liver_uss",
                                                  "type": "action",
                                                  "label": "Request Liver USS if not done since abnormal LFT have been noted",
                                                  "input_ids": [],
                                                  "edge_label": "",
                                                  "children": [
                                                    {
                                                      "id": "n_mandatory_testing",
                                                      "type": "action",
                                                      "label": "Mandatory Testing",
                                                      "input_ids": [],
                                                      "edge_label": "",
                                                      "children": [
                                                        {
                                                          "id": "n_phase4_bloods_main",
                                                          "type": "action",
                                                          "label": "Phase 4 Bloods",
                                                          "input_ids": [],
                                                          "edge_label": "",
                                                          "children": [
                                                            {
                                                              "id": "n_wilsons",
                                                              "type": "action",
                                                              "label": "Wilsons Disease Screen: Ceruloplasmin, Alpha 1 Antitrypsin (A1AT) Screen: A1AT",
                                                              "input_ids": [],
                                                              "edge_label": "",
                                                              "children": [
                                                                {
                                                                  "id": "d_transferrin",
                                                                  "type": "decision",
                                                                  "label": "Transferrin Sat >=45% Or Raised Ferritin?",
                                                                  "input_ids": [],
                                                                  "condition": {
                                                                    "input_id": "input_transferrin_sat_bool",
                                                                    "comparator": "is_true"
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "id": "n_haemochromatosis",
                                                                      "type": "action",
                                                                      "label": "Haemochromatosis Gene Test",
                                                                      "input_ids": [],
                                                                      "edge_label": "true",
                                                                      "children": [
                                                                        {
                                                                          "id": "d_raised_igm",
                                                                          "type": "decision",
                                                                          "label": "Raised IgM?",
                                                                          "input_ids": [],
                                                                          "condition": {
                                                                            "input_id": "input_raised_igm_bool",
                                                                            "comparator": "is_true"
                                                                          },
                                                                          "children": [
                                                                            {
                                                                              "id": "n_primary_biliary",
                                                                              "type": "action",
                                                                              "label": "Primary Biliary Cirrhosis Screen: AMA",
                                                                              "input_ids": [],
                                                                              "edge_label": "true",
                                                                              "children": [
                                                                                {
                                                                                  "id": "n_review_result",
                                                                                  "type": "action",
                                                                                  "label": "Review Result",
                                                                                  "input_ids": [],
                                                                                  "edge_label": "",
                                                                                  "children": [
                                                                                    {
                                                                                      "id": "d_review_abnormal",
                                                                                      "type": "decision",
                                                                                      "label": "Review Result abnormal?",
                                                                                      "input_ids": [],
                                                                                      "condition": {
                                                                                        "input_id": "input_review_result_enum",
                                                                                        "comparator": "enum_eq",
                                                                                        "value": "abnormal"
                                                                                      },
                                                                                      "children": [
                                                                                        {
                                                                                          "id": "n_telephone_consultation",
                                                                                          "type": "action",
                                                                                          "label": "Telephone Consultation",
                                                                                          "input_ids": [],
                                                                                          "edge_label": "true",
                                                                                          "children": [
                                                                                            {
                                                                                              "id": "d_referral_required",
                                                                                              "type": "decision",
                                                                                              "label": "Referral required to secondary care?",
                                                                                              "input_ids": [],
                                                                                              "condition": {
                                                                                                "input_id": "input_referral_required_bool",
                                                                                                "comparator": "is_true"
                                                                                              },
                                                                                              "children": [
                                                                                                {
                                                                                                  "id": "out_no_concern",
                                                                                                  "type": "output",
                                                                                                  "label": "No Concern, or escalation required",
                                                                                                  "edge_label": "false",
                                                                                                  "children": []
                                                                                                },
                                                                                                {
                                                                                                  "id": "n_phase4_bloods_secondary",
                                                                                                  "type": "action",
                                                                                                  "label": "Phase 4 Bloods",
                                                                                                  "input_ids": [],
                                                                                                  "edge_label": "true",
                                                                                                  "children": [
                                                                                                    {
                                                                                                      "id": "out_refer_secondary",
                                                                                                      "type": "output",
                                                                                                      "label": "Refer to Secondary Care once bloods are back, irrespective of diagnosis or if all tests normal",
                                                                                                      "edge_label": "",
                                                                                                      "children": []
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        },
                                                                                        {
                                                                                          "id": "out_no_concern2",
                                                                                          "type": "output",
                                                                                          "label": "No Concern, or escalation required",
                                                                                          "edge_label": "false",
                                                                                          "children": []
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "id": "n_review_result_no_igm",
                                                                              "type": "action",
                                                                              "label": "Review Result",
                                                                              "input_ids": [],
                                                                              "edge_label": "false",
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "id": "n_conditional_testing",
                                                                      "type": "action",
                                                                      "label": "Conditional Testing",
                                                                      "input_ids": [],
                                                                      "edge_label": "false",
                                                                      "children": [
                                                                        {
                                                                          "id": "d_uc_panca",
                                                                          "type": "decision",
                                                                          "label": "Ulcerative Colitis or P-ANCA positive?",
                                                                          "input_ids": [],
                                                                          "condition": {
                                                                            "input_id": "input_ulcerative_colitis_or_panca_bool",
                                                                            "comparator": "is_true"
                                                                          },
                                                                          "children": [
                                                                            {
                                                                              "id": "out_mrcp",
                                                                              "type": "output",
                                                                              "label": "Requires MRCP via Gastroenterology",
                                                                              "edge_label": "true",
                                                                              "children": []
                                                                            },
                                                                            {
                                                                              "id": "d_raised_igg",
                                                                              "type": "decision",
                                                                              "label": "Raised IgG?",
                                                                              "input_ids": [],
                                                                              "condition": {
                                                                                "input_id": "input_raised_igg_bool",
                                                                                "comparator": "is_true"
                                                                              },
                                                                              "edge_label": "false",
                                                                              "children": [
                                                                                {
                                                                                  "id": "n_autoimmune",
                                                                                  "type": "action",
                                                                                  "label": "Autoimmune Hepatitis Type 1 Screen: ANA, SMA; Autoimmune Hepatitis Type 2 Screen: LKM-1, SLA (not on EMIS)",
                                                                                  "input_ids": [],
                                                                                  "edge_label": "true",
                                                                                  "children": []
                                                                                },
                                                                                {
                                                                                  "id": "n_nafld_categories",
                                                                                  "type": "action",
                                                                                  "label": "NAFLD Fibrosis Score Categories / FIB 4 Categories",
                                                                                  "input_ids": [],
                                                                                  "edge_label": "false",
                                                                                  "children": [
                                                                                    {
                                                                                      "id": "d_nafld_score",
                                                                                      "type": "decision",
                                                                                      "label": "NAFLD Fibrosis Score <-1.455?",
                                                                                      "input_ids": [],
                                                                                      "condition": {
                                                                                        "input_id": "input_nafld_fibrosis_score_float",
                                                                                        "comparator": "lt",
                                                                                        "value": -1.455
                                                                                      },
                                                                                      "children": [
                                                                                        {
                                                                                          "id": "out_f0f2_manage",
                                                                                          "type": "output",
                                                                                          "label": "manage risk factors and co-morbidities - Annual Screening",
                                                                                          "edge_label": "true",
                                                                                          "children": []
                                                                                        },
                                                                                        {
                                                                                          "id": "d_nafld_indeterminate",
                                                                                          "type": "decision",
                                                                                          "label": "NAFLD Fibrosis Score -1.455 to 0.675?",
                                                                                          "input_ids": [],
                                                                                          "condition": {
                                                                                            "input_id": "input_nafld_fibrosis_score_float",
                                                                                            "comparator": "within_range",
                                                                                            "value": -1.455,
                                                                                            "value2": 0.675
                                                                                          },
                                                                                          "edge_label": "false",
                                                                                          "children": [
                                                                                            {
                                                                                              "id": "n_indeterminate",
                                                                                              "type": "action",
                                                                                              "label": "Indeterminate Score",
                                                                                              "input_ids": [],
                                                                                              "edge_label": "true",
                                                                                              "children": [
                                                                                                {
                                                                                                  "id": "d_fib4_low",
                                                                                                  "type": "decision",
                                                                                                  "label": "FIB-4 <1.3 (or <2.0 if age >=65)?",
                                                                                                  "input_ids": [],
                                                                                                  "condition": {
                                                                                                    "input_id": "input_fib4_low_risk_bool",
                                                                                                    "comparator": "is_true"
                                                                                                  },
                                                                                                  "children": [
                                                                                                    {
                                                                                                      "id": "out_low_risk_manage",
                                                                                                      "type": "output",
                                                                                                      "label": "manage risk factors and co-morbidities - Annual Screening",
                                                                                                      "edge_label": "true",
                                                                                                      "children": []
                                                                                                    },
                                                                                                    {
                                                                                                      "id": "d_fib4_intermediate",
                                                                                                      "type": "decision",
                                                                                                      "label": "FIB-4 >=1.3 to <2.67 (or >=2.0 if age >=65) Intermediate or High Risk?",
                                                                                                      "input_ids": [],
                                                                                                      "condition": {
                                                                                                        "input_id": "input_fib4_categories_enum",
                                                                                                        "comparator": "enum_eq",
                                                                                                        "value": "Intermediate or High Risk"
                                                                                                      },
                                                                                                      "edge_label": "false",
                                                                                                      "children": [
                                                                                                        {
                                                                                                          "id": "n_fibrous_scan",
                                                                                                          "type": "action",
                                                                                                          "label": "Fibrous Scan if available",
                                                                                                          "input_ids": [],
                                                                                                          "edge_label": "true",
                                                                                                          "children": [
                                                                                                            {
                                                                                                              "id": "n_phase4_from_scan",
                                                                                                              "type": "action",
                                                                                                              "label": "Phase 4 Bloods",
                                                                                                              "input_ids": [],
                                                                                                              "edge_label": "",
                                                                                                              "children": [
                                                                                                                {
                                                                                                                  "id": "out_refer_secondary2",
                                                                                                                  "type": "output",
                                                                                                                  "label": "Refer to Secondary Care once bloods are back, irrespective of diagnosis or if all tests normal",
                                                                                                                  "edge_label": "",
                                                                                                                  "children": []
                                                                                                                }
                                                                                                              ]
                                                                                                            }
                                                                                                          ]
                                                                                                        },
                                                                                                        {
                                                                                                          "id": "n_high_risk_phase4",
                                                                                                          "type": "action",
                                                                                                          "label": "Phase 4 Bloods",
                                                                                                          "input_ids": [],
                                                                                                          "edge_label": "false",
                                                                                                          "children": [
                                                                                                            {
                                                                                                              "id": "out_refer_secondary3",
                                                                                                              "type": "output",
                                                                                                              "label": "Refer to Secondary Care once bloods are back, irrespective of diagnosis or if all tests normal",
                                                                                                              "edge_label": "",
                                                                                                              "children": []
                                                                                                            }
                                                                                                          ]
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            },
                                                                                            {
                                                                                              "id": "n_f3f4",
                                                                                              "type": "action",
                                                                                              "label": "F3-F4 (Severe fibrosis or Cirrhosis)",
                                                                                              "input_ids": [],
                                                                                              "edge_label": "false",
                                                                                              "children": [
                                                                                                {
                                                                                                  "id": "n_phase4_f3f4",
                                                                                                  "type": "action",
                                                                                                  "label": "Phase 4 Bloods",
                                                                                                  "input_ids": [],
                                                                                                  "edge_label": "",
                                                                                                  "children": [
                                                                                                    {
                                                                                                      "id": "out_refer_secondary4",
                                                                                                      "type": "output",
                                                                                                      "label": "Refer to Secondary Care once bloods are back, irrespective of diagnosis or if all tests normal",
                                                                                                      "edge_label": "",
                                                                                                      "children": []
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "id": "out_code_normal",
                                          "type": "output",
                                          "label": "Code as normal USS and file",
                                          "edge_label": "false",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "id": "n_recheck2",
                                  "type": "action",
                                  "label": "Recheck Baseline Liver Profile in appropriate timeframe (findings present for <3 months)",
                                  "input_ids": [],
                                  "edge_label": "false",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": "out_normal2",
                          "type": "output",
                          "label": "Mark as Normal / Satisfactory",
                          "edge_label": "false",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  },
  "doubts": [
    "The diagram has many interconnected paths and feedback loops (e.g., Review Result feeding back to Telephone Consultation, Phase 4 Bloods appearing multiple times). A strict tree structure cannot fully represent these cycles without duplicating nodes.",
    "The 'Need to rationalise which Additional tests should be done for rare conditions' box and its connection to Phase 4 Bloods is ambiguous in terms of exact branching logic.",
    "The FIB-4 and NAFLD score thresholds for age >=65 adjustments are partially visible; exact cutoffs for all branches may not be fully captured.",
    "The 'Raised IgG >0.675' path leading to Autoimmune Hepatitis screens and its downstream connection back to Review Result is ambiguous.",
    "The Fibrous Scan branch and High Risk (>2.67 at any age) path both seem to lead to Phase 4 Bloods and then Refer to Secondary Care, but the exact branching from FIB-4 categories is hard to trace precisely.",
    "The 'Code as normal USS and file' output is associated with the FIB4/NAFLD being normal but the exact decision condition for this path vs the sustained worsening path is not fully clear from the image.",
    "The flow from 'Conditional Testing' back into the main NAFLD/FIB4 scoring path versus separate outputs is ambiguous."
  ],
  "variables": []
}